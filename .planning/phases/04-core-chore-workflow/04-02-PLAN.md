---
phase: 04-core-chore-workflow
plan: 02
type: execute
wave: 2
depends_on: ["04-01"]
files_modified:
  - src/routes/admin/chores/+page.svelte
  - src/lib/stores/masterChores.svelte.ts
autonomous: true

must_haves:
  truths:
    - "Admin can view list of all master chores"
    - "Admin can create new master chore with text, time slot, and animal category"
    - "Admin can edit existing master chore"
    - "Admin can delete (deactivate) master chore"
    - "Master chores display grouped by time slot"
  artifacts:
    - path: "src/routes/admin/chores/+page.svelte"
      provides: "Master chore management UI"
      min_lines: 100
    - path: "src/lib/stores/masterChores.svelte.ts"
      provides: "Reactive master chore store for admin"
      exports: ["masterChoreStore"]
  key_links:
    - from: "src/routes/admin/chores/+page.svelte"
      to: "src/convex/masterChores.ts"
      via: "useQuery for list, useConvexClient().mutation() for create/update/remove"
      pattern: "api\\.masterChores\\."
---

<objective>
Create admin UI for managing the master chore list with CRUD operations.

Purpose: Enable admin to define the recurring chores that will be cloned daily for workers.
Output: Working admin page at /admin/chores with create, edit, and delete functionality.
</objective>

<execution_context>
@/Users/mike.wojnarowski/.claude/get-shit-done/workflows/execute-plan.md
@/Users/mike.wojnarowski/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-core-chore-workflow/04-RESEARCH.md

# Prior plan outputs
@.planning/phases/04-core-chore-workflow/04-01-SUMMARY.md

# Existing admin patterns
@src/routes/admin/keys/+page.svelte
@src/routes/admin/+layout.svelte
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create master chore store for admin</name>
  <files>src/lib/stores/masterChores.svelte.ts</files>
  <action>
Create a Svelte 5 reactive store for master chores using $state:

```typescript
import type { Id } from '../../convex/_generated/dataModel';

type TimeSlot = 'morning' | 'afternoon' | 'evening';

interface MasterChore {
  _id: Id<"masterChores">;
  text: string;
  timeSlot: TimeSlot;
  animalCategory: string;
  sortOrder: number;
  isActive: boolean;
  createdAt: number;
  updatedAt: number;
}

interface GroupedMasterChores {
  timeSlot: TimeSlot;
  chores: MasterChore[];
}

class MasterChoreStore {
  items = $state<MasterChore[]>([]);
  isLoading = $state(true);

  // Group by time slot for display
  grouped = $derived.by(() => {
    const order: TimeSlot[] = ['morning', 'afternoon', 'evening'];
    const result: GroupedMasterChores[] = [];

    for (const slot of order) {
      const slotChores = this.items
        .filter(c => c.timeSlot === slot && c.isActive)
        .sort((a, b) => a.sortOrder - b.sortOrder);

      if (slotChores.length > 0) {
        result.push({ timeSlot: slot, chores: slotChores });
      }
    }
    return result;
  });

  // Hydrate from Convex query
  hydrateFromServer(serverChores: MasterChore[]): void {
    this.items = serverChores;
    this.isLoading = false;
  }
}

export const masterChoreStore = new MasterChoreStore();
```

This store will be hydrated from useQuery in the admin page component.
  </action>
  <verify>Run `bun run check` to verify no TypeScript errors</verify>
  <done>masterChoreStore class implemented with $state, $derived.by grouping, and hydrateFromServer method</done>
</task>

<task type="auto">
  <name>Task 2: Create admin chores management page</name>
  <files>src/routes/admin/chores/+page.svelte</files>
  <action>
Create the admin chore management page with:

**Layout:**
- Page title "Master Chore List"
- "Add Chore" button that shows a form
- Chores grouped by time slot (Morning, Afternoon, Evening)
- Each chore shows: text, animal category, edit/delete buttons

**Add/Edit Form (modal or inline):**
- Text input (required)
- Time slot select: morning/afternoon/evening
- Animal category input (text field with suggestions like: Chickens, Goats, Pigs, Garden, General)
- Save and Cancel buttons

**Functionality:**
- Use `useQuery(api.masterChores.list, {})` for data subscription
- Use `useConvexClient()` to get client for mutations (NOT useMutation - it doesn't exist in convex-svelte)
- Call `client.mutation(api.masterChores.create, {...})` for create
- Call `client.mutation(api.masterChores.update, {...})` for edit
- Call `client.mutation(api.masterChores.remove, {...})` for delete

**Styling (plain CSS, scoped styles):**
- Clean card layout for each time slot group
- List items with edit/delete icons
- Form with proper spacing
- Confirmation before delete

**Pattern from existing admin pages:**
```svelte
<script lang="ts">
  import { browser } from '$app/environment';
  import { useQuery, useConvexClient } from 'convex-svelte';
  import { api } from '../../../convex/_generated/api';

  const client = browser ? useConvexClient() : null;
  const masterChores = browser ? useQuery(api.masterChores.list, {}) : null;

  // Hydrate store when data changes
  $effect(() => {
    if (masterChores?.data) {
      masterChoreStore.hydrateFromServer(masterChores.data);
    }
  });

  async function handleCreate() {
    if (!client) return;
    await client.mutation(api.masterChores.create, {
      text: formText,
      timeSlot: formTimeSlot,
      animalCategory: formCategory
    });
  }
</script>
```

Add navigation link to /admin/chores in the admin layout or keys page.
  </action>
  <verify>Run `bun run build` to verify no errors. Start dev server, login as admin, navigate to /admin/chores.</verify>
  <done>Admin can create, view, edit, and delete master chores at /admin/chores</done>
</task>

</tasks>

<verification>
1. `bun run build` completes without errors
2. Navigate to /admin/chores (after admin login)
3. Create a master chore with text, time slot, and category
4. Verify it appears in the correct time slot group
5. Edit the chore and verify changes persist
6. Delete the chore and verify it disappears
7. Refresh page and verify persistence
</verification>

<success_criteria>
- Admin page accessible at /admin/chores
- Add form accepts text, time slot, and animal category
- Chores display grouped by time slot
- Edit updates chore in place
- Delete removes chore from list (soft delete via isActive=false)
- All operations sync to Convex in real-time
</success_criteria>

<output>
After completion, create `.planning/phases/04-core-chore-workflow/04-02-SUMMARY.md`
</output>
